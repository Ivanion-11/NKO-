<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç | AtomHeart Heroes</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body class="bg-gray-900">
    <!-- –ö—Ä–∞—Å–∏–≤—ã–π —Ñ–æ–Ω -->
    <div class="background-wrapper"></div>
    <div class="particles-container">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>
    <div class="light-rays">
        <div class="ray"></div>
        <div class="ray"></div>
        <div class="ray"></div>
        <div class="ray"></div>
    </div>
    
    <custom-navbar></custom-navbar>
    
    <main class="main-content container mx-auto px-4 py-8">
        <div class="max-w-6xl mx-auto">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="text-center mb-12 fade-in-up">
                <h1 class="text-5xl md:text-6xl font-black mb-6 gradient-text leading-tight">
                    –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
                </h1>
                <p class="text-xl text-gray-300 max-w-2xl mx-auto font-medium">
                    –£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–∞—à–∏–º–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏
                </p>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div class="card p-8 mb-8 fade-in-up" id="userProfile">
                <!-- –ü—Ä–æ—Ñ–∏–ª—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º -->
            <div class="card p-6 mb-8 fade-in-up">
                <div class="flex flex-wrap gap-4 justify-center">
                    <button onclick="showSection('events')" class="btn btn-primary btn-wave btn-icon">
                        <i data-feather="calendar" class="w-5 h-5"></i>
                        –ú–æ–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
                    </button>
                    <button onclick="showSection('organizations')" class="btn btn-accent btn-wave btn-icon">
                        <i data-feather="users" class="w-5 h-5"></i>
                        –ú–æ–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
                    </button>
                    <button onclick="showSection('stats')" class="btn btn-glass btn-wave btn-icon">
                        <i data-feather="bar-chart" class="w-5 h-5"></i>
                        –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                    </button>
                    <button onclick="showSection('recommendations')" class="btn btn-glass btn-wave btn-icon">
                        <i data-feather="star" class="w-5 h-5"></i>
                        –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
                    </button>
                </div>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —Ä–∞–∑–¥–µ–ª–æ–≤ -->
            <div id="contentSections">
                <!-- –†–∞–∑–¥–µ–ª –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π -->
                <div id="eventsSection" class="section-content">
                    <div class="card p-8 mb-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                            <i data-feather="calendar" class="w-6 h-6 mr-3 text-blue-600"></i>
                            –ú–æ–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
                        </h2>
                        
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8" id="eventsStats">
                            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                        
                        <!-- –°–ø–∏—Å–æ–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π -->
                        <div id="volunteerEventsContainer">
                            <!-- –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                </div>

                <!-- –†–∞–∑–¥–µ–ª –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π -->
                <div id="organizationsSection" class="section-content hidden">
                    <div class="card p-8 mb-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                            <i data-feather="users" class="w-6 h-6 mr-3 text-green-600"></i>
                            –ú–æ–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
                        </h2>
                        
                        <!-- –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –ù–ö–û -->
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8" id="subscribedOrganizations">
                            <!-- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                        
                        <!-- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ -->
                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i data-feather="compass" class="w-5 h-5 mr-2 text-purple-600"></i>
                                –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
                            </h3>
                            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="recommendedOrganizations">
                                <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –†–∞–∑–¥–µ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
                <div id="statsSection" class="section-content hidden">
                    <div class="card p-8 mb-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                            <i data-feather="bar-chart" class="w-6 h-6 mr-3 text-purple-600"></i>
                            –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                        </h2>
                        
                        <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                            <div class="text-center">
                                <div class="text-3xl font-bold text-blue-600 mb-2" id="totalEventsCount">0</div>
                                <div class="text-gray-600">–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-600 mb-2" id="organizationsCount">0</div>
                                <div class="text-gray-600">–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-purple-600 mb-2" id="hoursCount">0</div>
                                <div class="text-gray-600">–ß–∞—Å–æ–≤ –ø–æ–º–æ—â–∏</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-orange-600 mb-2" id="awardsCount">0</div>
                                <div class="text-gray-600">–ù–∞–≥—Ä–∞–¥</div>
                            </div>
                        </div>

                        <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                        <div class="grid md:grid-cols-2 gap-8">
                            <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –º–µ—Å—è—Ü–∞–º -->
                            <div>
                                <h3 class="text-lg font-bold text-gray-800 mb-4">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –º–µ—Å—è—Ü–∞–º</h3>
                                <div id="monthlyActivity" class="space-y-3">
                                    <!-- –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
                                </div>
                            </div>
                            
                            <!-- –õ—é–±–∏–º—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                            <div>
                                <h3 class="text-lg font-bold text-gray-800 mb-4">–õ—é–±–∏–º—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
                                <div id="favoriteCategories" class="space-y-3">
                                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –†–∞–∑–¥–µ–ª —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π -->
                <div id="recommendationsSection" class="section-content hidden">
                    <div class="card p-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                            <i data-feather="star" class="w-6 h-6 mr-3 text-yellow-500"></i>
                            –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è
                        </h2>
                        
                        <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º -->
                        <div id="personalRecommendations" class="space-y-4">
                            <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <custom-footer></custom-footer>
    
    <script src="components/navbar.js"></script>
    <script src="components/footer.js"></script>
    <script src="script.js"></script>
    <script src="components/volunteer-events.js"></script>
    <script>
        feather.replace();

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        document.addEventListener('DOMContentLoaded', function() {
            const currentVolunteer = JSON.parse(localStorage.getItem('currentVolunteer') || 'null');
            
            if (!currentVolunteer) {
                // –ï—Å–ª–∏ –≤–æ–ª–æ–Ω—Ç–µ—Ä –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                window.location.href = 'index.html';
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            updateUserProfile(currentVolunteer);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–¥–µ–ª–æ–≤
            loadEventsData();
            loadOrganizationsData();
            loadStatsData();
            loadRecommendationsData();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞–∑–¥–µ–ª –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            showSection('events');
        });

        function updateUserProfile(userData) {
            const userProfile = document.getElementById('userProfile');
            
            if (userProfile) {
                userProfile.innerHTML = `
                    <div class="flex flex-col md:flex-row items-start md:items-center">
                        <div class="w-32 h-32 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white text-4xl font-bold mb-6 md:mb-0 md:mr-8 shadow-2xl">
                            ${userData.fullName.charAt(0)}
                        </div>
                        <div class="flex-1">
                            <h1 class="text-3xl font-bold text-gray-800 mb-2">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${userData.fullName.split(' ')[0]}!</h1>
                            <p class="text-gray-600 text-lg mb-4">–í–∞—à –≥–æ—Ä–æ–¥: <span class="font-semibold text-blue-600">${userData.city}</span></p>
                            <div class="flex flex-wrap gap-3">
                                <span class="bg-blue-100 text-blue-800 px-4 py-2 rounded-full text-sm font-medium">üå± –ê–∫—Ç–∏–≤–Ω—ã–π –≤–æ–ª–æ–Ω—Ç—ë—Ä</span>
                                <span class="bg-green-100 text-green-800 px-4 py-2 rounded-full text-sm font-medium">‚≠ê –£—á–∞—Å—Ç–Ω–∏–∫ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</span>
                                <span class="bg-purple-100 text-purple-800 px-4 py-2 rounded-full text-sm font-medium">üèÜ –î–æ–±—Ä–æ–≤–æ–ª–µ—Ü</span>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤
        function showSection(sectionName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
            document.getElementById(sectionName + 'Section').classList.remove('hidden');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('.btn').forEach(btn => {
                btn.classList.remove('btn-primary', 'btn-accent');
                btn.classList.add('btn-glass');
            });
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            const activeButton = document.querySelector(`button[onclick="showSection('${sectionName}')"]`);
            if (activeButton) {
                activeButton.classList.remove('btn-glass');
                if (sectionName === 'events') {
                    activeButton.classList.add('btn-primary');
                } else if (sectionName === 'organizations') {
                    activeButton.classList.add('btn-accent');
                } else {
                    activeButton.classList.add('btn-primary');
                }
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
        function loadEventsData() {
            const currentVolunteer = JSON.parse(localStorage.getItem('currentVolunteer') || 'null');
            if (!currentVolunteer) return;

            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º—É –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞
            if (typeof volunteerEventsSystem !== 'undefined') {
                const volunteerEvents = volunteerEventsSystem.getVolunteerEvents(currentVolunteer.email);
                const stats = volunteerEventsSystem.getVolunteerStats(currentVolunteer.email);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                updateEventsStats(stats);
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
                displayVolunteerEvents(volunteerEvents);
            }
        }

        function updateEventsStats(stats) {
            const statsContainer = document.getElementById('eventsStats');
            if (statsContainer) {
                statsContainer.innerHTML = `
                    <div class="text-center card p-4">
                        <div class="text-2xl font-bold text-blue-600 mb-1">${stats.totalEvents}</div>
                        <div class="text-gray-600 text-sm">–í—Å–µ–≥–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</div>
                    </div>
                    <div class="text-center card p-4">
                        <div class="text-2xl font-bold text-green-600 mb-1">${stats.upcomingEvents}</div>
                        <div class="text-gray-600 text-sm">–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö</div>
                    </div>
                    <div class="text-center card p-4">
                        <div class="text-2xl font-bold text-purple-600 mb-1">${stats.completedEvents}</div>
                        <div class="text-gray-600 text-sm">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö</div>
                    </div>
                    <div class="text-center card p-4">
                        <div class="text-lg font-bold text-orange-600 mb-1">${stats.favoriteCategory}</div>
                        <div class="text-gray-600 text-sm">–õ—é–±–∏–º–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</div>
                    </div>
                `;
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
        function loadOrganizationsData() {
            // –ü–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const subscribedOrgs = JSON.parse(localStorage.getItem('subscribedOrganizations') || '[]');
            updateSubscribedOrganizations(subscribedOrgs);
            
            // –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
            loadRecommendedOrganizations();
        }

        function updateSubscribedOrganizations(organizations) {
            const container = document.getElementById('subscribedOrganizations');
            if (!container) return;

            if (organizations.length === 0) {
                container.innerHTML = `
                    <div class="col-span-3 text-center py-8">
                        <div class="w-16 h-16 mx-auto mb-4 bg-gray-200 rounded-2xl flex items-center justify-center text-gray-400">
                            <i data-feather="users" class="w-8 h-8"></i>
                        </div>
                        <h3 class="text-lg font-bold text-gray-800 mb-2">–í—ã –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</h3>
                        <p class="text-gray-600 mb-4">–ù–∞–π–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –ù–ö–û –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ</p>
                        <a href="nko.html" class="btn btn-primary btn-sm">
                            –ù–∞–π—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
                        </a>
                    </div>
                `;
            } else {
                container.innerHTML = organizations.map(org => `
                    <div class="card p-6 text-center group hover:scale-105 transition-all duration-300">
                        <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-2xl flex items-center justify-center text-white text-xl font-bold shadow-lg">
                            ${org.name.substring(0, 2)}
                        </div>
                        <h4 class="font-semibold text-gray-800 mb-2">${org.name}</h4>
                        <p class="text-gray-600 text-sm mb-3">${org.city}</p>
                        <div class="flex justify-center space-x-2">
                            <button onclick="unsubscribeFromOrganization(${org.id})" class="btn btn-border btn-xs">
                                –û—Ç–ø–∏—Å–∞—Ç—å—Å—è
                            </button>
                            <button onclick="viewOrganization(${org.id})" class="btn btn-glass btn-xs">
                                –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            feather.replace();
        }

        function loadRecommendedOrganizations() {
            const container = document.getElementById('recommendedOrganizations');
            if (!container) return;

            // –ü—Ä–∏–º–µ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
            const recommendedOrgs = [
                { id: 1, name: "–≠–∫–æ-–î—É–±–Ω–∞", city: "–î—É–±–Ω–∞", category: "–≠–∫–æ–ª–æ–≥–∏—è" },
                { id: 2, name: "–°–ø–æ—Ä—Ç –¥–ª—è –≤—Å–µ—Ö", city: "–î—É–±–Ω–∞", category: "–°–ø–æ—Ä—Ç" },
                { id: 3, name: "–ü–æ–º–æ—â—å –¥–µ—Ç—è–º", city: "–î—É–±–Ω–∞", category: "–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å" }
            ];

            container.innerHTML = recommendedOrgs.map(org => `
                <div class="card p-6 text-center group hover:scale-105 transition-all duration-300">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center text-white text-xl font-bold shadow-lg">
                        ${org.name.substring(0, 2)}
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">${org.name}</h4>
                    <p class="text-gray-600 text-sm mb-1">${org.city}</p>
                    <span class="inline-block bg-gray-100 text-gray-700 px-2 py-1 rounded-full text-xs mb-3">${org.category}</span>
                    <div class="flex justify-center space-x-2">
                        <button onclick="subscribeToOrganization(${org.id})" class="btn btn-primary btn-xs">
                            –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è
                        </button>
                        <button onclick="viewOrganization(${org.id})" class="btn btn-glass btn-xs">
                            –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                        </button>
                    </div>
                </div>
            `).join('');
            feather.replace();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function loadStatsData() {
            const currentVolunteer = JSON.parse(localStorage.getItem('currentVolunteer') || 'null');
            if (!currentVolunteer) return;

            // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            const stats = {
                totalEvents: 15,
                organizations: 8,
                hours: 120,
                awards: 3,
                monthlyActivity: [
                    { month: '–Ø–Ω–≤', events: 2 },
                    { month: '–§–µ–≤', events: 3 },
                    { month: '–ú–∞—Ä', events: 1 },
                    { month: '–ê–ø—Ä', events: 4 },
                    { month: '–ú–∞–π', events: 5 }
                ],
                categories: [
                    { name: '–≠–∫–æ–ª–æ–≥–∏—è', count: 6 },
                    { name: '–°–ø–æ—Ä—Ç', count: 4 },
                    { name: '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', count: 3 },
                    { name: '–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å', count: 2 }
                ]
            };

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('totalEventsCount').textContent = stats.totalEvents;
            document.getElementById('organizationsCount').textContent = stats.organizations;
            document.getElementById('hoursCount').textContent = stats.hours;
            document.getElementById('awardsCount').textContent = stats.awards;

            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            updateMonthlyActivity(stats.monthlyActivity);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª—é–±–∏–º—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            updateFavoriteCategories(stats.categories);
        }

        function updateMonthlyActivity(activity) {
            const container = document.getElementById('monthlyActivity');
            if (!container) return;

            const maxEvents = Math.max(...activity.map(a => a.events));
            
            container.innerHTML = activity.map(item => `
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600 w-8">${item.month}</span>
                    <div class="flex-1 mx-4">
                        <div class="bg-gray-200 rounded-full h-2">
                            <div class="bg-blue-500 rounded-full h-2" style="width: ${(item.events / maxEvents) * 100}%"></div>
                        </div>
                    </div>
                    <span class="text-sm font-semibold text-gray-800 w-8 text-right">${item.events}</span>
                </div>
            `).join('');
        }

        function updateFavoriteCategories(categories) {
            const container = document.getElementById('favoriteCategories');
            if (!container) return;

            const total = categories.reduce((sum, cat) => sum + cat.count, 0);
            
            container.innerHTML = categories.map(cat => `
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600">${cat.name}</span>
                    <div class="flex items-center space-x-2">
                        <div class="w-16 bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 rounded-full h-2" style="width: ${(cat.count / total) * 100}%"></div>
                        </div>
                        <span class="text-sm font-semibold text-gray-800 w-4">${cat.count}</span>
                    </div>
                </div>
            `).join('');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
        function loadRecommendationsData() {
            const container = document.getElementById('personalRecommendations');
            if (!container) return;

            // –ü—Ä–∏–º–µ—Ä —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
            const recommendations = [
                {
                    id: 1,
                    title: "–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—É–±–±–æ—Ç–Ω–∏–∫",
                    organization: "–≠–∫–æ-–î—É–±–Ω–∞",
                    date: "2024-06-15",
                    address: "–ì–æ—Ä–æ–¥—Å–∫–æ–π –ø–∞—Ä–∫",
                    category: "–≠–∫–æ–ª–æ–≥–∏—è",
                    description: "–ü–æ–º–æ–≥–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å –Ω–∞—à –≥–æ—Ä–æ–¥ —á–∏—â–µ! –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —É–±–æ—Ä–∫–µ –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ –ø–∞—Ä–∫–∞."
                },
                {
                    id: 2,
                    title: "–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–±–µ–≥",
                    organization: "–°–ø–æ—Ä—Ç –¥–ª—è –≤—Å–µ—Ö", 
                    date: "2024-06-20",
                    address: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å—Ç–∞–¥–∏–æ–Ω",
                    category: "–°–ø–æ—Ä—Ç",
                    description: "–ü—Ä–æ–±–µ–≥–∏—Ç–µ –¥–∏—Å—Ç–∞–Ω—Ü–∏—é –∏ –ø–æ–º–æ–≥–∏—Ç–µ —Å–æ–±—Ä–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è –¥–µ—Ç—Å–∫–æ–≥–æ –¥–æ–º–∞."
                }
            ];

            container.innerHTML = recommendations.map(event => `
                <div class="card p-6 hover:scale-105 transition-all duration-300 group">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-start justify-between mb-3">
                                <h4 class="text-lg font-bold text-gray-800 group-hover:text-blue-600 transition-colors">
                                    ${event.title}
                                </h4>
                                <div class="flex items-center space-x-2">
                                    <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium">
                                        –ù–æ–≤–æ–µ
                                    </span>
                                    <span class="${getCategoryColorClass(event.category)} text-white px-2 py-1 rounded-full text-xs font-medium">
                                        ${event.category}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-3">
                                <div class="flex items-center text-gray-600">
                                    <i data-feather="map-pin" class="w-4 h-4 mr-2 flex-shrink-0"></i>
                                    <span class="text-sm">${event.address}</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <i data-feather="calendar" class="w-4 h-4 mr-2 flex-shrink-0"></i>
                                    <span class="text-sm">${formatDate(event.date)}</span>
                                </div>
                                <div class="flex items-center text-gray-600">
                                    <i data-feather="users" class="w-4 h-4 mr-2 flex-shrink-0"></i>
                                    <span class="text-sm">${event.organization}</span>
                                </div>
                            </div>
                            
                            <p class="text-gray-600 text-sm mb-3 leading-relaxed">
                                ${event.description}
                            </p>
                            
                            <div class="flex items-center justify-between">
                                <button onclick="registerForEvent(${event.id})" class="btn btn-primary btn-sm">
                                    –ó–∞–ø–∏—Å–∞—Ç—å—Å—è
                                </button>
                                <button onclick="viewEventDetails(${event.id})" class="btn btn-glass btn-sm">
                                    –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            feather.replace();
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getCategoryColorClass(category) {
            const colors = {
                '–≠–∫–æ–ª–æ–≥–∏—è': 'bg-green-500',
                '–°–ø–æ—Ä—Ç': 'bg-red-500',
                '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': 'bg-blue-500',
                '–°–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å': 'bg-purple-500'
            };
            return colors[category] || 'bg-blue-500';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ru-RU', { 
                day: 'numeric', 
                month: 'long',
                year: 'numeric'
            });
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏
        function subscribeToOrganization(orgId) {
            const currentSubscriptions = JSON.parse(localStorage.getItem('subscribedOrganizations') || '[]');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω –ª–∏ —É–∂–µ
            if (!currentSubscriptions.find(org => org.id === orgId)) {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ API
                const newOrg = { id: orgId, name: "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è " + orgId, city: "–î—É–±–Ω–∞" };
                currentSubscriptions.push(newOrg);
                localStorage.setItem('subscribedOrganizations', JSON.stringify(currentSubscriptions));
                
                showNotification('–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é!', 'success');
                loadOrganizationsData();
            }
        }

        function unsubscribeFromOrganization(orgId) {
            let currentSubscriptions = JSON.parse(localStorage.getItem('subscribedOrganizations') || '[]');
            currentSubscriptions = currentSubscriptions.filter(org => org.id !== orgId);
            localStorage.setItem('subscribedOrganizations', JSON.stringify(currentSubscriptions));
            
            showNotification('–í—ã –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å –æ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏', 'success');
            loadOrganizationsData();
        }

        function viewOrganization(orgId) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
            window.location.href = `nko-single.html?id=${orgId}`;
        }

        function registerForEvent(eventId) {
            const currentVolunteer = JSON.parse(localStorage.getItem('currentVolunteer') || 'null');
            if (!currentVolunteer) return;

            if (typeof volunteerEventsSystem !== 'undefined') {
                const result = volunteerEventsSystem.registerVolunteer(eventId, {
                    email: currentVolunteer.email,
                    name: currentVolunteer.fullName,
                    phone: currentVolunteer.phone
                });

                if (result.success) {
                    showNotification(result.message, 'success');
                    loadEventsData();
                } else {
                    showNotification(result.message, 'error');
                }
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.showSection = showSection;
        window.subscribeToOrganization = subscribeToOrganization;
        window.unsubscribeFromOrganization = unsubscribeFromOrganization;
        window.viewOrganization = viewOrganization;
        window.registerForEvent = registerForEvent;
        window.viewEventDetails = viewEventDetails;
    </script>
</body>
</html>